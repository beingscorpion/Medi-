 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Dashboard</title>
    {% load static %}
    <link href="{% static 'css/dash.css' %}" rel="stylesheet">
    {% comment %} <link href="{% static 'css/tailwind.css' %}" rel="stylesheet"> {% endcomment %}
    {% comment %} <link href="{% static 'css/custom.css' %}" rel="stylesheet"> {% endcomment %}
 </head>
 <body>
    <header class="header">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">‚ò∞</button>
            <a href="{% url 'index' %}" style="text-decoration: none; color: inherit;">
                <div class="logo">
                    <img class="logo-icon" src="{% static 'images/logo.svg' %}" alt="MedSol">
                    <span>MedSol</span>
                </div>
            </a>
        </div>
         
         <div><button class="add-btn" id="logoutBtn" data-logout-url="{% url 'logout' %}">Logout</button></div>
     </header>

     <div class="sidebar-overlay" id="sidebarOverlay"></div>
 
     <main class="main">
         <aside class="sidebar">
             <div class="my-subjects">
                 <div style="display: flex; align-items: center; justify-content: center; width: 100%;">
                     <div style="font-weight: 600;">Dashboard</div>
                 </div>
             </div>
 
             <ul class="sidebar-menu">
                 <li><a href="#" data-view="mdcat" class="sidebar-active"><span class="icon math">üìö</span>MDcat</a></li>
                 <li><a href="#" data-view="past-paper"><span class="icon physics">üìÑ</span>Past Paper</a></li>
                 {% comment %} <li><a href="#"><span class="icon chemistry">üß™</span>Chemistry</a></li>
                 <li><a href="#"><span class="icon biology">üß¨</span>Biology</a></li>
                 <li><a href="#"><span class="icon english">üìù</span>English</a></li>
                 <li><a href="#"><span class="icon" style="background: #fef2f2; color: #dc2626;">üíª</span>Computer Science</a></li> {% endcomment %}
             </ul>
         </aside>
 
        <div class="content">
            <!-- Payment Status Banner -->
            {% if not payment_confirmed %}
            <div style="background: {% if pending_payment %}linear-gradient(135deg, #fbbf24, #f59e0b){% else %}linear-gradient(135deg, #ef4444, #dc2626){% endif %}; color: white; padding: 1rem 1.5rem; border-radius: 12px; margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
                <div style="display: flex; align-items: center; gap: 1rem; flex: 1;">
                    <div style="font-size: 1.5rem;">{% if pending_payment %}‚è≥{% else %}‚ö†Ô∏è{% endif %}</div>
                    <div>
                        <h3 style="font-weight: 600; margin-bottom: 0.25rem; font-size: 1.125rem;">
                            {% if pending_payment %}Payment Pending Verification{% else %}Payment Required{% endif %}
                        </h3>
                        <p style="font-size: 0.875rem; opacity: 0.95; margin: 0;">
                            {% if pending_payment %}
                            Your payment is being reviewed. You'll have access to all services once it's confirmed.
                            {% else %}
                            Please complete your payment to access all study materials and practice tests.
                            {% endif %}
                        </p>
                    </div>
                </div>
                {% if not pending_payment %}
                <a href="{% url 'payment' %}" style="background: white; color: #dc2626; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; text-decoration: none; transition: transform 0.2s; white-space: nowrap;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    Make Payment
                </a>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- MDcat View -->
            <div class="view-section active" data-view-section="mdcat">
                {% if subjects_data %}
                <div class="tabs" id="subject-tabs">
                    {% for subject_name, subject_data in subjects_data.items %}
                    <a href="#" class="tab {% if forloop.first %}active{% endif %}" data-tab="{{ subject_name }}">{{ subject_name }}</a>
                    {% endfor %}
                </div>



                {% for subject_name, subject_data in subjects_data.items %}
                <div class="tab-content {% if forloop.first %}active{% endif %}" data-content="{{ subject_name }}">
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-icon total">üìä</div>
                            <div class="stat-info">
                                <h3 id="{{ subject_name|lower }}-total">{{ subject_data.stats.total }}</h3>
                                <p>Total Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon pending">‚è≥</div>
                            <div class="stat-info">
                                <h3 id="{{ subject_name|lower }}-pending">{{ subject_data.stats.pending }}</h3>
                                <p>Pending Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon completed">‚úÖ</div>
                            <div class="stat-info">
                                <h3 id="{{ subject_name|lower }}-completed">{{ subject_data.stats.completed }}</h3>
                                <p>Completed</p>
                            </div>
                        </div>
                    </div>

                    <div class="section-header">
                        <h2>{{ subject_name }} Chapters</h2>
                    </div>

                    <div class="subjects-grid" id="{{ subject_name|lower }}-chapters">
                        {% for chapter_data in subject_data.chapters %}
                        <div class="subject-card" data-chapter="{{ chapter_data.chapter.slug }}">
                            <div class="subject-header">
                                <div class="subject-icon {% if subject_name == 'Biology' %}biology{% elif subject_name == 'Chemistry' %}chemistry{% elif subject_name == 'Physics' %}physics{% elif subject_name == 'English' %}english{% elif subject_name == 'Logical Reasoning' %}logical-reasoning{% endif %}">
                                    {% if subject_name == 'Biology' %}üß¨{% elif subject_name == 'Chemistry' %}üß™{% elif subject_name == 'Physics' %}‚öõ{% elif subject_name == 'English' %}üìù{% elif subject_name == 'Logical Reasoning' %}ü§î{% endif %}
                                </div>
                                <div class="subject-info">
                                    <h3>{{ chapter_data.chapter.title }}</h3>
                                    <p>{% if chapter_data.chapter.description %}{{ chapter_data.chapter.description }}{% else %}Chapter {{ chapter_data.chapter.chapter_no }}{% endif %}</p>
                                </div>
                            </div>
                            <div class="subject-stats">
                                <div class="subject-stat">
                                    <div class="number">{{ chapter_data.stats.total }}</div>
                                    <div class="label">Questions</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ chapter_data.stats.completed }}</div>
                                    <div class="label">Completed</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ chapter_data.stats.score|floatformat:0 }}%</div>
                                    <div class="label">Score</div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="subject-card">
                            <div class="subject-header">
                                <div class="subject-icon {% if subject_name == 'Biology' %}biology{% elif subject_name == 'Chemistry' %}chemistry{% elif subject_name == 'Physics' %}physics{% elif subject_name == 'English' %}english{% elif subject_name == 'Logical Reasoning' %}logical-reasoning{% endif %}">
                                    {% if subject_name == 'Biology' %}üß¨{% elif subject_name == 'Chemistry' %}üß™{% elif subject_name == 'Physics' %}‚öõ{% elif subject_name == 'English' %}üìù{% elif subject_name == 'Logical Reasoning' %}ü§î{% endif %}
                                </div>
                                <div class="subject-info">
                                    <h3>No Chapters Available</h3>
                                    <p>Add chapters for {{ subject_name }} in the admin panel</p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-icon total">üìä</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Total Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">‚è≥</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Pending Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon completed">‚úÖ</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Completed</p>
                        </div>
                    </div>
                </div>
                <div class="section-header">
                    <h2>Subjects</h2>
                </div>
                <div class="subjects-grid">
                    <div class="subject-card">
                        <div class="subject-header">
                            <div class="subject-icon physics">üìÑ</div>
                            <div class="subject-info">
                                <h3>No Subjects Available</h3>
                                <p>Add subjects in the admin panel</p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Past Paper View -->
            <div class="view-section" data-view-section="past-paper">
                {% if provinces_data %}
                <div class="tabs" id="province-tabs">
                    {% for province_name, province_data in provinces_data.items %}
                    <a href="#" class="tab {% if forloop.first %}active{% endif %}" data-tab="{{ province_name }}">{{ province_name }}</a>
                    {% endfor %}
                </div>

                {% for province_name, province_data in provinces_data.items %}
                <div class="tab-content {% if forloop.first %}active{% endif %}" data-content="{{ province_name }}">
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-icon total">üìä</div>
                            <div class="stat-info">
                                <h3>{{ province_data.stats.total }}</h3>
                                <p>Total Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon pending">‚è≥</div>
                            <div class="stat-info">
                                <h3>{{ province_data.stats.pending }}</h3>
                                <p>Pending Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon completed">‚úÖ</div>
                            <div class="stat-info">
                                <h3>{{ province_data.stats.completed }}</h3>
                                <p>Completed</p>
                            </div>
                        </div>
                    </div>

                    <div class="section-header">
                        <h2>{{ province_name }} Past Papers</h2>
                    </div>

                    <div class="subjects-grid" id="{{ province_name|lower }}-years">
                        {% for year_data in province_data.years %}
                        <div class="subject-card" data-year-slug="{{ year_data.year.slug }}">
                            <div class="subject-header">
                                <div class="subject-icon physics">üìÑ</div>
                                <div class="subject-info">
                                    <h3>{{ year_data.year.year }}</h3>
                                    <p>{{ province_name }} Past Paper</p>
                                </div>
                            </div>
                            <div class="subject-stats">
                                <div class="subject-stat">
                                    <div class="number">{{ year_data.stats.total }}</div>
                                    <div class="label">Questions</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ year_data.stats.completed }}</div>
                                    <div class="label">Completed</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ year_data.stats.score|floatformat:0 }}%</div>
                                    <div class="label">Score</div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="subject-card">
                            <div class="subject-header">
                                <div class="subject-icon physics">üìÑ</div>
                                <div class="subject-info">
                                    <h3>No Years Available</h3>
                                    <p>Add years for {{ province_name }} in the admin panel</p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-icon total">üìä</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Total Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">‚è≥</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Pending Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon completed">‚úÖ</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Completed</p>
                        </div>
                    </div>
                </div>
                <div class="section-header">
                    <h2>Past Papers</h2>
                </div>
                <div class="subjects-grid">
                    <div class="subject-card">
                        <div class="subject-header">
                            <div class="subject-icon physics">üìÑ</div>
                            <div class="subject-info">
                                <h3>No Provinces Available</h3>
                                <p>Add provinces in the admin panel</p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>

    <script src="{% static 'js/dash.js' %}"></script>
 </body>
 </html>