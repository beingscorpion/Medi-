 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Dashboard</title>
    {% comment %} {% load static %} {% endcomment %}
    {% comment %} <link href="{% static 'css/tailwind.css' %}" rel="stylesheet"> {% endcomment %}
    {% comment %} <link href="{% static 'css/custom.css' %}" rel="stylesheet"> {% endcomment %}
     <style>
         * {
             margin: 0;
             padding: 0;
             box-sizing: border-box;
         }
 
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            overflow-x: hidden;
        }

        body.sidebar-open {
            overflow: hidden;
        }
 
         .header {
             background: white;
             border-bottom: 1px solid #e2e8f0;
             padding: 0 2rem;
             height: 64px;
             display: flex;
             align-items: center;
             justify-content: space-between;
         }
 
         .logo {
             display: flex;
             align-items: center;
             gap: 0.5rem;
             font-weight: 700;
             font-size: 1.25rem;
         }
 
         .logo-icon {
             width: 32px;
             height: 32px;
             background: linear-gradient(135deg, #8b5cf6, #a855f7);
             border-radius: 6px;
             display: flex;
             align-items: center;
             justify-content: center;
             color: white;
             font-weight: bold;
         }
 
         .main {
             display: flex;
             height: calc(100vh - 64px);
         }
 
         .sidebar {
             width: 280px;
             background: white;
             border-right: 1px solid #e2e8f0;
             padding: 2rem 1rem;
             overflow-y: auto;
             scroll-behavior: smooth;
             -webkit-overflow-scrolling: touch;
         }
 
         .my-subjects {
             background: linear-gradient(135deg, #8b5cf6, #a855f7);
             color: white;
             border-radius: 12px;
             padding: 1rem;
             margin-bottom: 2rem;
             display: flex;
             align-items: center;
             gap: 0.75rem;
         }
 
         .sidebar-menu {
             list-style: none;
         }
 
         .sidebar-menu li {
             margin-bottom: 0.5rem;
         }
 
         .sidebar-menu a {
             display: flex;
             align-items: center;
             gap: 0.75rem;
             padding: 0.75rem;
             text-decoration: none;
             color: #64748b;
             border-radius: 8px;
             transition: all 0.2s;
         }
 
         .sidebar-menu a:hover {
             background: #f1f5f9;
             color: #1e293b;
         }
 
         .sidebar-menu .icon {
             width: 20px;
             height: 20px;
             border-radius: 4px;
             display: flex;
             align-items: center;
             justify-content: center;
             font-size: 12px;
         }
 
         .icon.math { background: #fef3c7; color: #d97706; }
         .icon.physics { background: #dbeafe; color: #2563eb; }
         .icon.chemistry { background: #dcfce7; color: #16a34a; }
         .icon.biology { background: #fce7f3; color: #db2777; }
         .icon.english { background: #f3e8ff; color: #9333ea; }
 
         .content {
             flex: 1;
             padding: 2rem;
             overflow-y: auto;
             scroll-behavior: smooth;
             -webkit-overflow-scrolling: touch;
         }
 
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: white;
            padding: 0.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            overflow-x: auto;
            scrollbar-width: none;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 0.875rem 1.75rem;
            color: #64748b;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.9375rem;
            position: relative;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 110px;
            white-space: nowrap;
            letter-spacing: 0.01em;
        }

        .tab:hover {
            color: #8b5cf6;
            background: #f3e8ff;
            transform: translateY(-1px);
        }

        .tab.active {
            color: white;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
            transform: translateY(-2px);
        }

        .tab.active:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
        }
 
         .stats {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
             gap: 1.5rem;
             margin-bottom: 2rem;
         }
 
         .stat-card {
             background: white;
             border-radius: 12px;
             padding: 1.5rem;
             border: 1px solid #e2e8f0;
             display: flex;
             align-items: center;
             gap: 1rem;
         }
 
         .stat-icon {
             width: 48px;
             height: 48px;
             border-radius: 12px;
             display: flex;
             align-items: center;
             justify-content: center;
             font-size: 20px;
             color: white;
         }
 
         .stat-icon.total { background: #fbbf24; }
         .stat-icon.pending { background: #60a5fa; }
         .stat-icon.completed { background: #34d399; }
 
         .stat-info h3 {
             font-size: 1.5rem;
             font-weight: 700;
             color: #1e293b;
         }
 
         .stat-info p {
             color: #64748b;
             font-size: 0.875rem;
         }
 
         .subjects-grid {
             display: grid;
             grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
             gap: 1.5rem;
         }
 
         .subject-card {
             background: white;
             border-radius: 12px;
             border: 1px solid #e2e8f0;
             overflow: hidden;
             transition: all 0.2s;
             cursor: pointer;
         }
 
         .subject-card:hover {
             transform: translateY(-2px);
             box-shadow: 0 8px 25px -8px rgba(0,0,0,0.15);
         }
 
         .subject-header {
             padding: 1.5rem;
             display: flex;
             align-items: center;
             gap: 1rem;
             border-bottom: 1px solid #f1f5f9;
         }
 
         .subject-icon {
             width: 48px;
             height: 48px;
             border-radius: 12px;
             display: flex;
             align-items: center;
             justify-content: center;
             font-size: 20px;
             color: white;
         }
 
         .subject-icon.physics { background: linear-gradient(135deg, #3b82f6, #2563eb); }
         .subject-icon.chemistry { background: linear-gradient(135deg, #10b981, #16a34a); }
         .subject-icon.biology { background: linear-gradient(135deg, #ec4899, #db2777); }
         .subject-icon.english { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
         .subject-icon.logical-reasoning { background: linear-gradient(135deg, #ef4444, #dc2626); }
 
         .subject-info h3 {
             font-weight: 600;
             color: #1e293b;
             margin-bottom: 0.25rem;
         }
 
         .subject-info p {
             color: #64748b;
             font-size: 0.875rem;
         }
 
         .subject-stats {
             padding: 1rem 1.5rem;
             display: flex;
             justify-content: space-between;
             background: #f8fafc;
         }
 
         .subject-stat {
             text-align: center;
         }
 
         .subject-stat .number {
             font-weight: 700;
             font-size: 1.125rem;
             color: #1e293b;
         }
 
         .subject-stat .label {
             font-size: 0.75rem;
             color: #64748b;
             margin-top: 0.25rem;
         }
 
         .add-btn {
             background: linear-gradient(135deg, #8b5cf6, #7c3aed);
             color: white;
             border: none;
             border-radius: 8px;
             padding: 0.75rem 1.5rem;
             font-weight: 500;
             cursor: pointer;
             transition: all 0.2s;
             margin-left: auto;
         }
 
         .add-btn:hover {
             transform: translateY(-1px);
             box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
         }
 
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .subject-card.selected {
            border: 2px solid #8b5cf6;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
        }

        .view-section {
            display: none;
        }

        .view-section.active {
            display: block;
        }

        .sidebar-menu a.sidebar-active {
            background: #f3e8ff;
            color: #8b5cf6;
            font-weight: 600;
        }

        /* Mobile Menu Toggle Button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #1e293b;
            padding: 0.5rem;
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .sidebar-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            .header {
                padding: 0 1rem;
                height: 56px;
                position: relative;
                z-index: 1000;
            }

            .logo {
                font-size: 1rem;
            }

            .logo-icon {
                width: 28px;
                height: 28px;
            }

            .menu-toggle {
                display: block;
                margin-right: 0.5rem;
            }

            .add-btn {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }

            .main {
                height: calc(100vh - 56px);
                position: relative;
            }

            .sidebar {
                position: fixed;
                left: -280px;
                top: 56px;
                height: calc(100vh - 56px);
                width: 280px;
                z-index: 999;
                transition: left 0.3s ease;
                box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
            }

            .sidebar.active {
                left: 0;
            }

            .sidebar-overlay {
                display: block;
                top: 56px;
            }

            .content {
                padding: 1rem;
                width: 100%;
                margin-left: 0;
                min-width: 0;
                overflow-x: hidden;
            }

            .tabs {
                padding: 0.375rem;
                gap: 0.375rem;
                margin-bottom: 1.5rem;
            }

            .tab {
                padding: 0.75rem 1.25rem;
                font-size: 0.875rem;
                min-width: 90px;
            }

            .stats {
                grid-template-columns: 1fr;
                gap: 1rem;
                margin-bottom: 1.5rem;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .stat-info h3 {
                font-size: 1.25rem;
            }

            .stat-info p {
                font-size: 0.8125rem;
            }

            .subjects-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .subject-header {
                padding: 1rem;
            }

            .subject-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .subject-info h3 {
                font-size: 1rem;
            }

            .subject-info p {
                font-size: 0.8125rem;
            }

            .subject-stats {
                padding: 0.75rem 1rem;
            }

            .subject-stat .number {
                font-size: 1rem;
            }

            .subject-stat .label {
                font-size: 0.6875rem;
            }

            .section-header {
                margin-bottom: 1rem;
            }

            .section-header h2 {
                font-size: 1.125rem;
            }

            .my-subjects {
                padding: 0.75rem;
                margin-bottom: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 0 0.75rem;
            }

            .logo span {
                display: none;
            }

            .content {
                padding: 0.75rem;
            }

            .tab {
                padding: 0.625rem 1rem;
                font-size: 0.8125rem;
                min-width: 80px;
            }

            .stat-card {
                padding: 0.875rem;
            }

            .subject-header {
                padding: 0.875rem;
            }

            .subject-stats {
                padding: 0.625rem 0.875rem;
            }
        }
     </style>
 </head>
 <body>
    <header class="header">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">‚ò∞</button>
            <a href="{% url 'index' %}" style="text-decoration: none; color: inherit;">
                <div class="logo">
                    <div class="logo-icon">Q</div>
                    <span>MedSol</span>
                </div>
            </a>
        </div>
         
         <div><button class="add-btn" id="logoutBtn">logout</button></div>
     </header>

     <div class="sidebar-overlay" id="sidebarOverlay"></div>
 
     <main class="main">
         <aside class="sidebar">
             <div class="my-subjects">
                 <div style="display: flex; align-items: center; justify-content: center;">
                     <div style="font-weight: 600; padding-left: 10px;">Dashboard</div>
                 </div>
             </div>
 
             <ul class="sidebar-menu">
                 <li><a href="#" data-view="mdcat" class="sidebar-active"><span class="icon math"></span>MDcat</a></li>
                 <li><a href="#" data-view="past-paper"><span class="icon physics"></span>Past Paper</a></li>
                 {% comment %} <li><a href="#"><span class="icon chemistry">üß™</span>Chemistry</a></li>
                 <li><a href="#"><span class="icon biology">üß¨</span>Biology</a></li>
                 <li><a href="#"><span class="icon english">üìù</span>English</a></li>
                 <li><a href="#"><span class="icon" style="background: #fef2f2; color: #dc2626;">üíª</span>Computer Science</a></li> {% endcomment %}
             </ul>
         </aside>
 
        <div class="content">
            <!-- MDcat View -->
            <div class="view-section active" data-view-section="mdcat">
                {% if subjects_data %}
                <div class="tabs" id="subject-tabs">
                    {% for subject_name, subject_data in subjects_data.items %}
                    <a href="#" class="tab {% if forloop.first %}active{% endif %}" data-tab="{{ subject_name }}">{{ subject_name }}</a>
                    {% endfor %}
                </div>

                {% for subject_name, subject_data in subjects_data.items %}
                <div class="tab-content {% if forloop.first %}active{% endif %}" data-content="{{ subject_name }}">
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-icon total">üìä</div>
                            <div class="stat-info">
                                <h3 id="{{ subject_name|lower }}-total">{{ subject_data.stats.total }}</h3>
                                <p>Total Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon pending">‚è≥</div>
                            <div class="stat-info">
                                <h3 id="{{ subject_name|lower }}-pending">{{ subject_data.stats.pending }}</h3>
                                <p>Pending Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon completed">‚úÖ</div>
                            <div class="stat-info">
                                <h3 id="{{ subject_name|lower }}-completed">{{ subject_data.stats.completed }}</h3>
                                <p>Completed</p>
                            </div>
                        </div>
                    </div>

                    <div class="section-header">
                        <h2>{{ subject_name }} Chapters</h2>
                    </div>

                    <div class="subjects-grid" id="{{ subject_name|lower }}-chapters">
                        {% for chapter_data in subject_data.chapters %}
                        <div class="subject-card" data-chapter="{{ chapter_data.chapter.slug }}">
                            <div class="subject-header">
                                <div class="subject-icon {% if subject_name == 'Biology' %}biology{% elif subject_name == 'Chemistry' %}chemistry{% elif subject_name == 'Physics' %}physics{% elif subject_name == 'English' %}english{% elif subject_name == 'Logical Reasoning' %}logical-reasoning{% endif %}">
                                    {% if subject_name == 'Biology' %}üß¨{% elif subject_name == 'Chemistry' %}üß™{% elif subject_name == 'Physics' %}‚öõ{% elif subject_name == 'English' %}üìù{% elif subject_name == 'Logical Reasoning' %}ü§î{% endif %}
                                </div>
                                <div class="subject-info">
                                    <h3>{{ chapter_data.chapter.title }}</h3>
                                    <p>{% if chapter_data.chapter.description %}{{ chapter_data.chapter.description }}{% else %}Chapter {{ chapter_data.chapter.chapter_no }}{% endif %}</p>
                                </div>
                            </div>
                            <div class="subject-stats">
                                <div class="subject-stat">
                                    <div class="number">{{ chapter_data.stats.total }}</div>
                                    <div class="label">Questions</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ chapter_data.stats.completed }}</div>
                                    <div class="label">Completed</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ chapter_data.stats.score|floatformat:0 }}%</div>
                                    <div class="label">Score</div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="subject-card">
                            <div class="subject-header">
                                <div class="subject-icon {% if subject_name == 'Biology' %}biology{% elif subject_name == 'Chemistry' %}chemistry{% elif subject_name == 'Physics' %}physics{% elif subject_name == 'English' %}english{% elif subject_name == 'Logical Reasoning' %}logical-reasoning{% endif %}">
                                    {% if subject_name == 'Biology' %}üß¨{% elif subject_name == 'Chemistry' %}üß™{% elif subject_name == 'Physics' %}‚öõ{% elif subject_name == 'English' %}üìù{% elif subject_name == 'Logical Reasoning' %}ü§î{% endif %}
                                </div>
                                <div class="subject-info">
                                    <h3>No Chapters Available</h3>
                                    <p>Add chapters for {{ subject_name }} in the admin panel</p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-icon total">üìä</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Total Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">‚è≥</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Pending Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon completed">‚úÖ</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Completed</p>
                        </div>
                    </div>
                </div>
                <div class="section-header">
                    <h2>Subjects</h2>
                </div>
                <div class="subjects-grid">
                    <div class="subject-card">
                        <div class="subject-header">
                            <div class="subject-icon physics">üìÑ</div>
                            <div class="subject-info">
                                <h3>No Subjects Available</h3>
                                <p>Add subjects in the admin panel</p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Past Paper View -->
            <div class="view-section" data-view-section="past-paper">
                {% if provinces_data %}
                <div class="tabs" id="province-tabs">
                    {% for province_name, province_data in provinces_data.items %}
                    <a href="#" class="tab {% if forloop.first %}active{% endif %}" data-tab="{{ province_name }}">{{ province_name }}</a>
                    {% endfor %}
                </div>

                {% for province_name, province_data in provinces_data.items %}
                <div class="tab-content {% if forloop.first %}active{% endif %}" data-content="{{ province_name }}">
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-icon total">üìä</div>
                            <div class="stat-info">
                                <h3>{{ province_data.stats.total }}</h3>
                                <p>Total Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon pending">‚è≥</div>
                            <div class="stat-info">
                                <h3>{{ province_data.stats.pending }}</h3>
                                <p>Pending Questions</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon completed">‚úÖ</div>
                            <div class="stat-info">
                                <h3>{{ province_data.stats.completed }}</h3>
                                <p>Completed</p>
                            </div>
                        </div>
                    </div>

                    <div class="section-header">
                        <h2>{{ province_name }} Past Papers</h2>
                    </div>

                    <div class="subjects-grid" id="{{ province_name|lower }}-years">
                        {% for year_data in province_data.years %}
                        <div class="subject-card" data-year-slug="{{ year_data.year.slug }}">
                            <div class="subject-header">
                                <div class="subject-icon physics">üìÑ</div>
                                <div class="subject-info">
                                    <h3>{{ year_data.year.year }}</h3>
                                    <p>{{ province_name }} Past Paper</p>
                                </div>
                            </div>
                            <div class="subject-stats">
                                <div class="subject-stat">
                                    <div class="number">{{ year_data.stats.total }}</div>
                                    <div class="label">Questions</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ year_data.stats.completed }}</div>
                                    <div class="label">Completed</div>
                                </div>
                                <div class="subject-stat">
                                    <div class="number">{{ year_data.stats.score|floatformat:0 }}%</div>
                                    <div class="label">Score</div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="subject-card">
                            <div class="subject-header">
                                <div class="subject-icon physics">üìÑ</div>
                                <div class="subject-info">
                                    <h3>No Years Available</h3>
                                    <p>Add years for {{ province_name }} in the admin panel</p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-icon total">üìä</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Total Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">‚è≥</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Pending Questions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon completed">‚úÖ</div>
                        <div class="stat-info">
                            <h3>0</h3>
                            <p>Completed</p>
                        </div>
                    </div>
                </div>
                <div class="section-header">
                    <h2>Past Papers</h2>
                </div>
                <div class="subjects-grid">
                    <div class="subject-card">
                        <div class="subject-header">
                            <div class="subject-icon physics">üìÑ</div>
                            <div class="subject-info">
                                <h3>No Provinces Available</h3>
                                <p>Add provinces in the admin panel</p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>

 
    <script>
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle functionality
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.querySelector('.sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');

            function toggleSidebar() {
                if (sidebar && sidebarOverlay) {
                    const isActive = sidebar.classList.contains('active');
                    sidebar.classList.toggle('active');
                    sidebarOverlay.classList.toggle('active');
                    // Prevent body scroll when sidebar is open
                    if (!isActive) {
                        document.body.classList.add('sidebar-open');
                    } else {
                        document.body.classList.remove('sidebar-open');
                    }
                }
            }

            function closeSidebar() {
                if (sidebar && sidebarOverlay) {
                    sidebar.classList.remove('active');
                    sidebarOverlay.classList.remove('active');
                    document.body.classList.remove('sidebar-open');
                }
            }

            if (menuToggle) {
                menuToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleSidebar();
                });
            }

            if (sidebarOverlay) {
                sidebarOverlay.addEventListener('click', closeSidebar);
            }

            // Close sidebar when clicking on a sidebar link (mobile)
            document.querySelectorAll('.sidebar-menu a').forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        closeSidebar();
                    }
                });
            });

            // Handle window resize - close sidebar on mobile when resizing to desktop
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    if (window.innerWidth > 768) {
                        closeSidebar();
                    }
                }, 250);
            });

                // Sidebar view switching functionality
            document.querySelectorAll('.sidebar-menu a[data-view]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const viewType = this.getAttribute('data-view');
                    
                    // Remove active class from all sidebar links
                    document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('sidebar-active'));
                    this.classList.add('sidebar-active');
                    
                    // Hide all view sections
                    document.querySelectorAll('.view-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show selected view section
                    const viewSection = document.querySelector(`[data-view-section="${viewType}"]`);
                    if (viewSection) {
                        viewSection.classList.add('active');
                    }
                });
            });

            // Tab switching functionality (works for both MDcat and Past Paper)
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Get the parent view section
                    const viewSection = this.closest('.view-section');
                    if (!viewSection) return;
                    
                    // Remove active class from all tabs in this view section
                    viewSection.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Hide all tab content in this view section
                    viewSection.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show selected tab content
                    const tabName = this.getAttribute('data-tab');
                    const content = viewSection.querySelector(`[data-content="${tabName}"]`);
                    if (content) {
                        content.classList.add('active');
                    }
                });
            });

            // Chapter card click functionality (for MDcat)
            document.querySelectorAll('[data-view-section="mdcat"] .subject-card[data-chapter]').forEach(card => {
                card.addEventListener('click', function() {
                    const chapter = this.getAttribute('data-chapter');
                    
                    // Remove selected class from all cards in the same tab
                    const currentTab = this.closest('.tab-content');
                    if (currentTab) {
                        currentTab.querySelectorAll('.subject-card').forEach(c => c.classList.remove('selected'));
                    }
                    this.classList.add('selected');
                    
                    // Navigate to paper selection page for this chapter
                    if (chapter) {
                        window.location.href = `/chapter/${chapter}/`;
                    }
                });
            });

            // Year card click functionality (for Past Paper)
            document.querySelectorAll('[data-view-section="past-paper"] .subject-card[data-year-slug]').forEach(card => {
                card.addEventListener('click', function() {
                    const yearSlug = this.getAttribute('data-year-slug');
                    
                    // Remove selected class from all cards in the same tab
                    const currentTab = this.closest('.tab-content');
                    if (currentTab) {
                        currentTab.querySelectorAll('.subject-card').forEach(c => c.classList.remove('selected'));
                    }
                    this.classList.add('selected');
                    
                    // Navigate to past paper MCQs for this year
                    if (yearSlug) {
                        window.location.href = `/past-paper/${yearSlug}/`;
                    }
                });
            });

            // Logout button
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    if (confirm('Are you sure you want to logout?')) {
                        window.location.href = '{% url 'logout' %}';
                    }
                });
            }
        });
    </script>
 </body>
 </html>